"use strict";(self["webpackChunkcars_admin"]=self["webpackChunkcars_admin"]||[]).push([[683],{3185:function(t,e,a){a.d(e,{Z:function(){return u}});var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-cascader",{class:{"cascader-input":t.initValueFlag},attrs:{filterable:"",placeholder:t.initValue,options:t.cascader_options,props:t.cascader_props},on:{change:t.changeValue},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})},s=[],i=a(9322),n={name:"",data(){const t=this;return{address:[],addressData:{},value:[],cascader_options:[],cascader_props:{lazy:!0,lazyLoad(e,a){const r=e.level,s={},n={0:{type:"province"},1:{type:"city",code:"province"},2:{type:"area",code:"city"}};n[r].code&&(s[`${n[r].code}_code`]=e.value),s.type=n[r].type,(0,i.Df)(s).then((e=>{const s=e.data.data,i=n[r].type.toUpperCase();s.forEach((t=>{t.value=t[`${i}_CODE`],t.label=t[`${i}_NAME`],2===r&&(t.leaf=r>=2)})),t.addressData[n[r].type]=s,a(s)})),0!==e.level&&t.getAddress(e)}},initValue:"请选择省市区",initValueFlag:!1}},methods:{initDefault(t){t&&(this.initValueFlag=!0,this.initValue=t.split(",").join(" / "))},changeValue(t){this.$emit("update:cityAreaValue",t.join());const e=t[t.length-1],a=this.addressData.area.filter((t=>t.value==e))[0];this.address[2]=a.label,this.getAddress()},getAddress(t){if(t){const e=t.level-1;this.address[e]=t.label}this.mapLocation&&this.$emit("callback",{function:"setMapCenter",data:{address:this.address.join("")}})},clear(){console.log(11111),this.value=""}},components:{},props:{mapLocation:{type:Boolean,default:!1},cityAreaValue:{type:String,default:""}}},o=n,l=a(1001),c=(0,l.Z)(o,r,s,!1,null,"1a447781",null),u=c.exports},3540:function(t,e,a){a.r(e),a.d(e,{default:function(){return C}});var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"parking-add"},[a("VueForm",{ref:"vueForm",attrs:{formData:t.form_data,formItme:t.form_item,formHandler:t.form_handler},scopedSlots:t._u([{key:"maintain",fn:function(){return[a("el-row",{attrs:{gutter:30}},[a("el-col",{attrs:{span:6}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:t.form_data.maintainDate,callback:function(e){t.$set(t.form_data,"maintainDate",e)},expression:"form_data.maintainDate"}})],1),a("el-col",{attrs:{span:6}},[t._v("下次保养日期：2020-12-12")])],1)]},proxy:!0},{key:"energy",fn:function(){return[a("el-radio-group",{on:{change:t.changeEnergyType},model:{value:t.form_data.energyType,callback:function(e){t.$set(t.form_data,"energyType",e)},expression:"form_data.energyType"}},t._l(t.energyType,(function(e){return a("el-radio",{key:e.value,attrs:{label:e.value}},[t._v(t._s(e.label))])})),1),3==t.form_data.energyType||1==t.form_data.energyType?a("div",{staticClass:"progress-bar-wrap"},[a("span",{staticClass:"label-text"},[t._v("电量：")]),a("el-row",[a("el-col",{attrs:{span:10}},[a("el-slider",{attrs:{"show-input":""},model:{value:t.form_data.electric,callback:function(e){t.$set(t.form_data,"electric",e)},expression:"form_data.electric"}})],1)],1)],1):t._e(),3==t.form_data.energyType||2==t.form_data.energyType?a("div",{staticClass:"progress-bar-wrap"},[a("span",{staticClass:"label-text"},[t._v("油量：")]),a("el-row",[a("el-col",{attrs:{span:10}},[a("el-slider",{attrs:{"show-input":""},model:{value:t.form_data.oil,callback:function(e){t.$set(t.form_data,"oil",e)},expression:"form_data.oil"}})],1)],1)],1):t._e()]},proxy:!0},{key:"carsAttr",fn:function(){return[a("CarsAttr",{ref:"carsAttr",attrs:{oil:t.form_data.oil,initValue:t.form_data.carsAttr,countKm:t.form_data.countKm,value:t.form_data.carsAttr},on:{"update:countKm":function(e){return t.$set(t.form_data,"countKm",e)},"update:count-km":function(e){return t.$set(t.form_data,"countKm",e)},"update:value":function(e){return t.$set(t.form_data,"carsAttr",e)}}})]},proxy:!0},{key:"leaseList",fn:function(){return[a("el-row",{attrs:{gutter:20}},t._l(t.leaseListData,(function(e){return a("el-col",{key:e.carsLeaseTypeId,attrs:{span:4}},[a("div",[t._v(t._s(e.carsLeaseTypeName))]),a("el-input-number",{staticStyle:{width:"100%"},attrs:{"controls-position":"right",min:0,max:1e4,placeholder:"请输入价格"},model:{value:e.price,callback:function(a){t.$set(e,"price",a)},expression:"item.price"}})],1)})),1)]},proxy:!0}])})],1)},s=[],i=(a(7658),a(9466)),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("CarsBasisAttr",{on:{getAttrList:t.getAttrList}}),t._v(" "+t._s(t.countKm)+" "),a("el-row",{attrs:{gutter:15}},t._l(t.attr_data,(function(e){return a("el-col",{key:e.key,attrs:{span:4}},[a("span",[t._v(t._s(e.value))]),a("el-input",{attrs:{placeholder:e.value},model:{value:t.attr_item[t.attr_basis_data.key][e.key],callback:function(a){t.$set(t.attr_item[t.attr_basis_data.key],e.key,a)},expression:"attr_item[attr_basis_data.key][item.key]"}})],1)})),1)],1)},o=[],l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",t._l(t.cars_list_basis_item,(function(e){return a("el-button",{key:e.id,attrs:{type:t.cars_list_basis_type_id==e.id?"danger":"",size:"small",a:e.id},on:{click:function(a){return t.getTypeList(e)}}},[t._v(" "+t._s(e.value)+" ")])})),1)},c=[],u=a(401),d={name:"CarsAttr",data(){return{cars_list_basis_item:[],cars_list_basis_type_id:"",current_cars_type_data:{}}},components:{},beforeMount(){this.getCarsTypeBasis()},methods:{getTypeList(t){this.cars_list_basis_type_id=t.id,this.current_cars_type_data=t,this.getAttrList()},getCarsTypeBasis(){(0,u.Aj)().then((t=>{const e=t.data.data;this.cars_list_basis_item=e}))},getAttrList(){(0,u.YE)({typeId:this.current_cars_type_data.id}).then((t=>{this.$emit("getAttrList",{attr_basis_data:this.current_cars_type_data,attr_data:t.data.data})}))}},props:{}},p=d,m=a(1001),f=(0,m.Z)(p,l,c,!1,null,"0a11805a",null),_=f.exports,h={name:"CarsAttr",data(){return{attr_data:[],attr_basis_data:{},attr_item:{}}},components:{CarsBasisAttr:_},computed:{countKm(){if(!this.attr_item.basics||!this.attr_item.basics.true_oil_consume||!this.attr_item.carsBody||!this.attr_item.carsBody.tank_volume)return"";const t=this.oil*this.attr_item.carsBody.tank_volume/100,e=t/this.attr_item.basics.true_oil_consume*100;this.$emit("update:countKm",e.toFixed(2))}},beforeMount(){},methods:{getAttrList(t){this.attr_basis_data=t.attr_basis_data,this.attr_data=t.attr_data,this.attrFormat()},attrFormat(){if(0==this.attr_data.length)return!1;const t=this.attr_basis_data.key;if(this.attr_item[t])return!1;const e={};this.attr_data.forEach((t=>{e[t.key]=""})),this.$set(this.attr_item,t,e)},callbackValue(){this.$emit("update:value",JSON.stringify(this.attr_item))}},props:{initValue:{type:String,default:""},oil:{type:Number,default:0}},watch:{initValue:{handler(t){t&&(this.attr_item=JSON.parse(t))},immediate:!0}}},y=h,g=(0,m.Z)(y,n,o,!1,null,"15a6810c",null),b=g.exports,v=a(9322),k=a(7805),L=a(4224),A={name:"ParkingAdd",components:{VueForm:i.Z,CarsAttr:b},data(){return{id:this.$route.query.id,editor:null,energyType:this.$store.state.config.energyType,cars_attr:[],form_item:[{type:"Select",label:"车辆品牌",placeholder:"请选择车辆品牌",prop:"carsBrandId",select_vlaue:"id",select_label:"nameCh",options:[],required:!0},{type:"Select",label:"停车场",placeholder:"请选择停车场",select_vlaue:"id",select_label:"parkingName",prop:"parkingId",options:[],required:!0},{type:"Input",label:"车辆型号",placeholder:"请输入车辆型号",prop:"carsMode",required:!0},{type:"Input",label:"车牌号",placeholder:"请输入车牌号",prop:"carsNumber",required:!0},{type:"Input",label:"车架号",placeholder:"请输入车架号",prop:"carsFrameNumber",required:!0},{type:"Upload",label:"缩略图",placeholder:"请上传缩略图",prop:"carsImg",required:!1},{type:"Input",label:"发动机号",placeholder:"请输入发动机号",prop:"engineNumber",required:!0},{type:"Radio",label:"年检",placeholder:"请选择年检",prop:"yearCheck",options:this.$store.state.config.year_check},{type:"Slot",slotName:"maintain",prop:"maintainDate",label:"保养日期"},{type:"Radio",label:"档位",placeholder:"请选择档位",prop:"gear",options:this.$store.state.config.gear},{type:"Slot",slotName:"energy",prop:"energyType",label:"能源类型"},{type:"Input",label:"可行驶公里",prop:"countKm"},{type:"Slot",slotName:"carsAttr",prop:"carsAttr",label:"车辆属性"},{type:"Wangeditor",prop:"content",label:"车辆描述"},{type:"Slot",slotName:"leaseList",prop:"lease",label:"租赁价格"},{type:"Disabled",label:"禁启用",placeholder:"请选择禁启用",prop:"status"}],form_handler:[{label:"确定",key:"submit",type:"danger",handler:()=>this.formValidate()},{label:"重置",key:"reset"}],form_data:{parkingId:"",carsBrandId:"",carsMode:"",carsNumber:"",carsFrameNumber:"",engineNumber:"",carsImg:"",countKm:"",yearCheck:!0,gear:1,energyType:2,electric:100,oil:100,carsAttr:"",content:"",maintainDate:"",status:!0},leaseListData:[],carsBrandList:[],uploadData:{token:""}}},beforeMount(){this.getCarsBrandList(),this.getParkingList(),this.getDetailed(),this.getLeaseList()},mounted(){},methods:{formValidate(){this.formatCarsAttr(),this.$refs.vueForm.$refs.form.validate((t=>{if(!t)return console.log("error submit!!"),!1;this.id?this.edit():this.add()}))},edit(){(0,k.ge)({...this.form_data,id:this.id,leasePrice:this.leaseListData}).then((t=>{this.$message({message:t.message,type:"success"})}))},add(){(0,k.em)({...this.form_data,leasePrice:this.leaseListData}).then((t=>{this.$message({message:t.message,type:"success"}),this.$refs.vueForm.resetForm(),this.cars_attr=[],this.form_data.content=""}))},getCarsBrandList(){(0,v.oG)().then((t=>{const e=t.data.data;if(e){const t=this.form_item.filter((t=>"carsBrandId"==t.prop));t.length>0&&(t[0].options=e)}}))},getParkingList(){(0,v.Re)().then((t=>{const e=t.data.data;if(e){const t=this.form_item.filter((t=>"parkingId"==t.prop));t.length>0&&(t[0].options=e)}}))},getDetailed(){if(!this.id)return!1;(0,k.z9)({id:this.id}).then((t=>{const e=t.data;if(!e)return!1;for(let a in e)Object.keys(this.form_data).includes(a)&&(this.form_data[a]=e[a]);this.leaseListData=e.leasePrice,console.log(this.form_data)}))},getLeaseList(){if(this.id)return!1;(0,L.as)().then((t=>{const e=t.data.data;e&&(this.leaseListData=e)}))},addCarsAttr(){this.cars_attr.push({attr_key:"",attr_value:""})},delCarsAttr(t){this.cars_attr.splice(t,1)},formatCarsAttr(){this.$refs.carsAttr.callbackValue()},changeEnergyType(t){this.form_data.oil=0,this.form_data.electric=0}}},$=A,D=(0,m.Z)($,r,s,!1,null,null,null),C=D.exports},7805:function(t,e,a){a.d(e,{$u:function(){return l},VD:function(){return s},em:function(){return n},ge:function(){return o},z9:function(){return i}});var r=a(4471);function s(t={}){return r.Z.request({method:"post",url:"/cars/status/",data:t})}function i(t={}){return r.Z.request({method:"post",url:"/cars/carsDetailed/",data:t})}function n(t={}){return r.Z.request({method:"post",url:"/cars/carsInfoAdd/",data:t})}function o(t={}){return r.Z.request({method:"post",url:"/cars/carsInfoEdit/",data:t})}function l(t={}){return r.Z.request({method:"post",url:"/cars/lock/",data:t})}},401:function(t,e,a){a.d(e,{Aj:function(){return s},YE:function(){return i},nj:function(){return n}});var r=a(4471);function s(t={}){return r.Z.request({method:"post",url:"/carsAttr/type/",data:t})}function i(t={}){return r.Z.request({method:"post",url:"/carsAttr/list/",data:t})}function n(t={}){return r.Z.request({method:"post",url:"/carsAttr/add/",data:t})}},9322:function(t,e,a){a.d(e,{HG:function(){return l},oG:function(){return c},Df:function(){return n},Re:function(){return u},Hp:function(){return d},Vj:function(){return o}});var r=a(4471);const s={parkingList:"/parking/list/",parkingListDelete:"/parking/delete/",brandList:"/brand/list/",brandListDelete:"/brand/delete/",carsList:"/cars/list/",carsListDelete:"/cars/delete/",carsAttrList:"/carsAttr/list/",leaseList:"/lease/list/",memberList:"/member/list/",memberListDelete:"/member/delete/",orderList:"/order/list/"};var i=s;function n(t={}){return r.Z.request({method:"post",url:"/cityPicker/",data:t})}function o(t={}){return r.Z.request({method:"post",url:i[t.url],data:t.data})}function l(t={}){return r.Z.request({method:"post",url:i[t.url],data:t.data})}function c(t={}){return r.Z.request({method:"post",url:"/common/getCarsBrand/",data:t})}function u(t={}){return r.Z.request({method:"post",url:"/common/getParking/",data:t})}function d(t={}){return r.Z.request({method:"post",url:"/uploadImgToken/",data:t})}},4224:function(t,e,a){a.d(e,{De:function(){return n},GY:function(){return i},WO:function(){return o},as:function(){return s}});var r=a(4471);function s(t={}){return r.Z.request({method:"post",url:"/lease/carsLeaseList/",data:t})}function i(t={}){return r.Z.request({method:"post",url:"/lease/add/",data:t})}function n(t={}){return r.Z.request({method:"post",url:"/lease/status/",data:t})}function o(t={}){return r.Z.request({method:"post",url:"/lease/edit/",data:t})}}}]);