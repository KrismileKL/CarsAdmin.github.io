"use strict";(self["webpackChunkcars_admin"]=self["webpackChunkcars_admin"]||[]).push([[428],{7176:function(t,e,a){a.d(e,{Z:function(){return p}});var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{staticClass:"cars-dialog-center",attrs:{title:t.data.parkingName,visible:t.dialogVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogVisible=e},close:t.close,opened:t.opened}},[a("div",{staticStyle:{height:"500px"}},[a("AMap",{ref:"aMap"})],1)])},n=[],s=a(427),i={name:"",components:{AMap:s.Z},props:{flagVisible:{type:Boolean,default:!1},data:{type:Object,default:()=>{}}},data(){return{dialogVisible:!1}},methods:{opened(){this.$refs.aMap.mapCreate(),this.$nextTick((()=>{const t=this.data.lnglat.split(","),e={lng:t[0],lat:t[1]};this.$refs.aMap.setMarker(e)}))},close(){this.$refs.aMap.mapDestroy(),this.$emit("update:flagVisible",!1)}},watch:{flagVisible:{handler(t,e){this.dialogVisible=t}}}},o=i,r=a(1001),c=(0,r.Z)(o,l,n,!1,null,"1a0487f8",null),p=c.exports},1407:function(t,e,a){a.r(e),a.d(e,{default:function(){return m}});var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"filter-form"},[a("el-row",[a("el-col",{attrs:{span:21}},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.form}},[a("el-form-item",{attrs:{label:"区域"}},[a("CityArea",{ref:"cityArea",attrs:{cityAreaValue:t.form.area},on:{"update:cityAreaValue":function(e){return t.$set(t.form,"area",e)},"update:city-area-value":function(e){return t.$set(t.form,"area",e)},callback:t.callbackComponent}})],1),a("el-form-item",{attrs:{label:"类型"}},[a("el-select",{staticClass:"width-120",attrs:{placeholder:"停车场"},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},t._l(t.parking_type,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:"禁启用"}},[a("el-select",{staticClass:"width-120",attrs:{placeholder:"请选择"},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},t._l(t.parking_status,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:"关键字"}},[a("el-select",{staticClass:"width-120",attrs:{placeholder:"请选择"},model:{value:t.search_key,callback:function(e){t.search_key=e},expression:"search_key"}},[a("el-option",{attrs:{label:"停车场名称",value:"parkingName"}}),a("el-option",{attrs:{label:"详细区域",value:"address"}})],1)],1),a("el-form-item",[a("el-input",{attrs:{placeholder:"请输入关键字按Enter搜索"},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"danger"},on:{click:t.search}},[t._v("搜索")])],1)],1)],1),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"pull-right"},[a("router-link",{attrs:{to:"/parkingAdd"}},[a("el-button",{attrs:{type:"danger"}},[t._v("新增停车场")])],1)],1)])],1)],1),a("TabalData",{ref:"table",attrs:{config:t.table_config},scopedSlots:t._u([{key:"status",fn:function(e){return[a("el-switch",{attrs:{disabled:e.data.id==t.switch_disabled,"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(a){return t.switchChange(e.data)}},model:{value:e.data.status,callback:function(a){t.$set(e.data,"status",a)},expression:"slotData.data.status"}})]}},{key:"lnglat",fn:function(e){return[a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(a){return t.showMap(e.data)}}},[t._v("查看地图")])]}}])}),a("MapLocation",{attrs:{flagVisible:t.map_show,data:t.parking_data},on:{"update:flagVisible":function(e){t.map_show=e},"update:flag-visible":function(e){t.map_show=e}}})],1)},n=[],s=a(3185),i=a(7176),o=a(9771),r=a(4050),c=a(7662),p={name:"Parking",data(){return{table_config:{thead:[{label:"停车场名称",prop:"parkingName"},{label:"类型",prop:"type",type:"function",callback:(t,e)=>(0,c.Fz)(t[e])},{label:"区域",prop:"address",type:"function",callback:(t,e)=>(0,c.Lk)(t[e])},{label:"可停放车辆",prop:"carsNumber"},{label:"禁启用",prop:"status",type:"slot",slotName:"status"},{label:"查看位置",prop:"lnglat",type:"slot",slotName:"lnglat"},{label:"操作",type:"operation",default:{deleteButton:!0,editButton:!0,editButtonLink:"ParkingAdd"}}],url:"parkingList",data:{pageSize:10,pageNumber:1}},form:{area:"",type:"",status:""},switch_disabled:"",switch_flag:!1,search_key:"",keyword:"",parking_status:this.$store.state.config.radio_disabled,parking_type:this.$store.state.config.parking_type,map_show:!1,parking_data:{},table_loading:!1,rowId:""}},components:{CityArea:s.Z,MapLocation:i.Z,TabalData:o.Z},methods:{callbackComponent(t){t.function&&this[t.function](t.data)},search(){const t={pageSize:10,pageNumber:1},e=JSON.parse(JSON.stringify(this.form));for(let a in e)e[a]&&(t[a]=e[a]);this.keyword&&this.search_key&&(t[this.search_key]=this.keyword),this.$refs.table.requestData(t)},switchChange(t){if(this.switch_flag)return!1;const e={id:t.id,status:t.status};this.switch_disabled=t.id,(0,r.Y1)(e).then((t=>{this.$message({type:"success",message:t.message}),this.switch_disabled=""})).catch((t=>{this.switch_disabled=""}))},showMap(t){this.map_show=!0,this.parking_data=t}},beforeMount(){},mounted(){}},u=p,d=a(1001),f=(0,d.Z)(u,l,n,!1,null,"3934da7c",null),m=f.exports},427:function(t,e,a){a.d(e,{Z:function(){return h}});var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"amap-wrap"},[a("el-amap",{staticClass:"amap-demo",attrs:{vid:"amapContainer",events:t.events}})],1)},n=[],s=a(5275);function i(t){return{lng:t.lnglat.getLng(),lat:t.lnglat.getLat(),value:t.lnglat.getLng()+","+t.lnglat.getLat()}}function o(t,e){const a=new AMap.Geocoder;a.getLocation(t,(function(t,a){if(console.log(a),"complete"===t&&"OK"==a.info){let t=a.geocodes[0].location.lat,l=a.geocodes[0].location.lng;e.setCenter([l,t]),console.log(t,l)}}))}let r=null;function c(t,e){r&&(e.remove(r),r=null),r=new AMap.Marker({position:[t.lng,t.lat]}),e.add(r),e.setFitView()}function p(t){r&&(t.remove(r),r=null)}var u={name:"Amap",data(){return{lnglat:{},map:null,zoom:18,events:{}}},mounted(){s.lazyAMapApiLoaderInstance.load().then((()=>{this.mapCreate(),this.map.on("click",(t=>{const e=i(t);this.lnglat=e,this.$emit("callback",{function:"getLnglat",data:{lnglat:e}}),this.setMarker()}))}))},methods:{mapCreate(t){this.map=new AMap.Map("amapContainer",{center:[121.59996,31.197646],zoom:this.zoom}),this.map.on("complete",(()=>{this.mapLoad()}))},mapLoad(){this.options.mapLoad&&this.$emit("callback",{function:"mapLoad"})},mapDestroy(){this.map&&this.map.destroy()},setMapCenter(t){o(t,this.map)},setMarker(t){c(t||this.lnglat,this.map)},clearMarker(){p(this.map)}},props:{options:{type:Object,default:()=>{}}}},d=u,f=a(1001),m=(0,f.Z)(d,l,n,!1,null,null,null),h=m.exports},7662:function(t,e,a){a.d(e,{Fz:function(){return s},Lk:function(){return n},Mk:function(){return o},tl:function(){return i}});var l=a(403);function n(t){let e=t,a="";if(e){let t=e.split(",");a+=t[0],t[1]&&(a+=`<br/>${t[1]}`)}return a}function s(t){const e=l.Z.state.config.parking_type_json[t];if(e)return e.label}function i(t){const e=l.Z.state.config.year_check,a=e.filter((e=>e.value===t));return a.length>0?a[0].label:""}function o(t){const e=l.Z.state.config.energyType,a=e.filter((e=>e.value===parseInt(t)));return a.length>0?a[0].label:""}}}]);